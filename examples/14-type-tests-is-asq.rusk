// 14 - 运行时类型测试：`is` 与 `as?`
//
// 当你手里拿到的是“接口值”（比如 `Animal`）时，可以在运行时做：
// - `x is T`：得到 `bool`，判断底层具体类型是不是 `T`
// - `x as? T`：安全向下转型，得到 `Option::Some(T)` 或 `Option::None`
//
// 对比（TypeScript）：
//   if ("name" in x) { ... } // 或自定义 type guard

interface Animal { fn speak() -> string; }

struct Dog { name: string }
struct Cat { name: string }

impl Animal for Dog {
    fn speak() -> string { f"{self.name}: woof" }
}

impl Animal for Cat {
    fn speak() -> string { f"{self.name}: meow" }
}

fn main() {
    let a = (Dog { name: "Rex" } as Animal);

    if a is Dog {
        std::println("a is a Dog");
    } else {
        std::println("a is not a Dog");
    };

    match a as? Cat {
        Option::Some(_c) => std::println("cast to Cat succeeded (unexpected)")
        Option::None => std::println("cast to Cat failed (as expected)")
    };

    std::println(a.speak());
    ()
}
